---
title: Fastställa den optimala kombinationen av överlappande rabatter
description: När rabatterna överlappar måste du fastställ vilken kombination av överlappande rabatter som ger det lägsta transaktionssumman eller den högsta rabattsumman. När rabattbeloppet varierar beroende på priset på de produkter som köps, så som den vanliga butiksrabatten "Köp 1, få 1 X procent rabatt" (BOGO), blir processen en fråga om kombinatorisk optimering.
author: kfend
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailParameters, RetailPeriodicDiscount,
audience: Application User, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations, Retail
ms.custom: 89643
ms.assetid: 09843c9a-3e19-4e4a-a8ce-80650f2095f9
ms.search.region: global
ms.search.industry: Retail
ms.author: kfend
ms.search.validFrom: 2016-05-31
ms.dyn365.ops.version: AX 7.0.1
ms.openlocfilehash: e327f652855f898e50f1dd853ae20f3a0ff41d9e
ms.sourcegitcommit: e2fb0846fcc6298050a0ec82c302e5eb5254e0b5
ms.translationtype: HT
ms.contentlocale: sv-SE
ms.lasthandoff: 05/27/2019
ms.locfileid: "1607010"
---
# <a name="determine-the-optimal-combination-of-overlapping-discounts"></a><span data-ttu-id="03cea-104">Fastställa den optimala kombinationen av överlappande rabatter</span><span class="sxs-lookup"><span data-stu-id="03cea-104">Determine the optimal combination of overlapping discounts</span></span>

[!include [banner](includes/banner.md)]

<span data-ttu-id="03cea-105">När rabatterna överlappar måste du fastställ vilken kombination av överlappande rabatter som ger det lägsta transaktionssumman eller den högsta rabattsumman.</span><span class="sxs-lookup"><span data-stu-id="03cea-105">When discounts overlap, you must determine the combination of overlapping discounts that will produce the lowest transaction total or the highest total discount.</span></span> <span data-ttu-id="03cea-106">När rabattbeloppet varierar beroende på priset på de produkter som köps, så som den vanliga butiksrabatten "Köp 1, få 1 X procent rabatt" (BOGO), blir processen en fråga om kombinatorisk optimering.</span><span class="sxs-lookup"><span data-stu-id="03cea-106">When the discount amount varies according to the price of the products that are purchased, such as in the common "Buy 1, get 1 X percent off" (BOGO) retail discount, this process becomes an issue of combinatorial optimization.</span></span>

<span data-ttu-id="03cea-107">Den här artikeln avser Microsoft Dynamics AX 2012 R3 KB 3105973 (utgiven 2 november 2015) eller senare och till Microsoft Dynamics 365 for Retail.</span><span class="sxs-lookup"><span data-stu-id="03cea-107">This article applies to Microsoft Dynamics AX 2012 R3 with KB 3105973 (released November 2, 2015) or later, and to Microsoft Dynamics 365 for Retail.</span></span> <span data-ttu-id="03cea-108">För att fastställa kombinationen av överlappande rabatter som ska tillämpas vid rätt tidpunkt har vi introducerat en metod för att använda överlappande rabatter.</span><span class="sxs-lookup"><span data-stu-id="03cea-108">To determine the combination overlapping discounts to apply in a timely manner, we have introduced a method for applying overlapping discounts.</span></span> <span data-ttu-id="03cea-109">Den nya metoden kallas **marginalvärderankning**.</span><span class="sxs-lookup"><span data-stu-id="03cea-109">We call this new method **marginal value ranking**.</span></span> <span data-ttu-id="03cea-110">Marginalvärderankning används när den tid som krävs för att utvärdera möjliga kombinationer av överlappande rabatter överskrider ett tröskelvärde som kan konfigureras på sidan **Butiksparametrar**.</span><span class="sxs-lookup"><span data-stu-id="03cea-110">Marginal value ranking is used when the time that is required in order to evaluate the possible combinations of overlapping discounts exceeds a threshold that is configurable on the **Retail parameters** page.</span></span> <span data-ttu-id="03cea-111">I metoden marginalvärderankning beräknas ett värde för varje överlappande rabatt genom att använda rabattvärdet på de delade produkterna.</span><span class="sxs-lookup"><span data-stu-id="03cea-111">In the marginal value ranking method, a value is calculated for each overlapping discount by using the discount's value on the shared products.</span></span> <span data-ttu-id="03cea-112">Överlappande rabatter tillämpas sedan från det högsta relativa värdet till det lägsta relativa värdet.</span><span class="sxs-lookup"><span data-stu-id="03cea-112">The overlapped discounts are then applied from the highest relative value to the lowest relative value.</span></span> <span data-ttu-id="03cea-113">Mer information om den nya metoden finns i avsnittet "Marginalvärde" nedan.</span><span class="sxs-lookup"><span data-stu-id="03cea-113">For details about the new method, see the "Marginal value" section, later in this article.</span></span> <span data-ttu-id="03cea-114">Marginalvärderankning används inte när rabattbeloppen för en produkt inte påverkas av en annan produkt i transaktionen.</span><span class="sxs-lookup"><span data-stu-id="03cea-114">Marginal value ranking isn't used when the discount amounts for a product aren't affected by another product in the transaction.</span></span> <span data-ttu-id="03cea-115">Denna metod används exempelvis inte för två enkla rabatter, eller för en enkel rabatt och en enda produktkvantitetsrabatt.</span><span class="sxs-lookup"><span data-stu-id="03cea-115">For example, this method isn't used for two simple discounts, or for a simple discount and a single product quantity discount.</span></span>

## <a name="discount-examples"></a><span data-ttu-id="03cea-116">Exempel på rabatter</span><span class="sxs-lookup"><span data-stu-id="03cea-116">Discount examples</span></span>

<span data-ttu-id="03cea-117">Du kan skapa ett obegränsat antal butiksrabatter för en gemensam uppsättning produkter.</span><span class="sxs-lookup"><span data-stu-id="03cea-117">You can create an unlimited number of retail discounts on a common set of products.</span></span> <span data-ttu-id="03cea-118">Men eftersom det inte finns någon gräns kan prestandaproblem uppstå när du försöker att beräkna rabatterna som ska användas för de olika produkterna.</span><span class="sxs-lookup"><span data-stu-id="03cea-118">However, because there is no limit, performance issues can occur when you try to calculate the discounts that should be used on the various products.</span></span> <span data-ttu-id="03cea-119">Följande exempel visar det här problemet i detalj.</span><span class="sxs-lookup"><span data-stu-id="03cea-119">The following examples illustrate this issue in more detail.</span></span> <span data-ttu-id="03cea-120">I exempel 1 börjar vi med två produkter och två överlappande rabatter.</span><span class="sxs-lookup"><span data-stu-id="03cea-120">In example 1, we start with two products and two overlapping discounts.</span></span> <span data-ttu-id="03cea-121">Sedan, i exempel 2, visar vi hur problemet utvecklas när fler produkter läggs till.</span><span class="sxs-lookup"><span data-stu-id="03cea-121">Then, in example 2, we show how the issue evolves as more products are added.</span></span>

### <a name="example-1-two-products-and-two-discounts"></a><span data-ttu-id="03cea-122">Exempel 1: Två produkter och två rabatter</span><span class="sxs-lookup"><span data-stu-id="03cea-122">Example 1: Two products and two discounts</span></span>

<span data-ttu-id="03cea-123">I det här exemplet krävs två produkter för att kvalificera sig för varje rabatt och rabatterna kan inte kombineras.</span><span class="sxs-lookup"><span data-stu-id="03cea-123">In this example, two products are required in order to qualify for each discount, and the discounts can't be combined.</span></span> <span data-ttu-id="03cea-124">Rabatterna i det här exemplet är **Bästa pris**-rabatter.</span><span class="sxs-lookup"><span data-stu-id="03cea-124">The discounts in this example are **Best price** discounts.</span></span> <span data-ttu-id="03cea-125">Båda produkterna uppfyller kraven för båda rabatterna.</span><span class="sxs-lookup"><span data-stu-id="03cea-125">Both products qualify for both discounts.</span></span> <span data-ttu-id="03cea-126">Här följer två rabatter.</span><span class="sxs-lookup"><span data-stu-id="03cea-126">Here are the two discounts.</span></span>

![Exempel på två bästa prisrabatter](./media/overlapping-discount-combo-01.jpg)

<span data-ttu-id="03cea-128">För två valfria produkter vilar den bättre av dessa två rabatter på priserna för de två produkterna.</span><span class="sxs-lookup"><span data-stu-id="03cea-128">For any two products, the better of these two discounts depends on the prices of the two products.</span></span> <span data-ttu-id="03cea-129">När priset för båda produkterna är nästan lika eller lika, är rabatt 1 bättre.</span><span class="sxs-lookup"><span data-stu-id="03cea-129">When the price of both products is equal or almost equal, discount 1 is better.</span></span> <span data-ttu-id="03cea-130">När priset på en produkt är betydligt mindre än priset på den andra produkten, är rabatt 2 bättre.</span><span class="sxs-lookup"><span data-stu-id="03cea-130">When the price of one product is significantly less than the price of the other product, discount 2 is better.</span></span> <span data-ttu-id="03cea-131">Här följer den matematiska regeln för att bedöma dessa två rabatter mot varandra.</span><span class="sxs-lookup"><span data-stu-id="03cea-131">Here is the mathematical rule for evaluating these two discounts against each other.</span></span>

![Regel för utvärdering av rabatterna](./media/overlapping-discount-combo-02.jpg)

> [!NOTE]
> <span data-ttu-id="03cea-133">När priset för produkt 1 är lika med två tredjedelar av priset för produkt 2, väger de två rabatterna lika.</span><span class="sxs-lookup"><span data-stu-id="03cea-133">When the price of product 1 is equal to two-thirds of the price of product 2, the two discounts are equal.</span></span> <span data-ttu-id="03cea-134">I det här exemplet varierar rabattprocenten för rabatt 1 från några procent (när priserna för de två produkterna ligger långt från varandra) till högst 25 procent (när de två produkterna har samma pris).</span><span class="sxs-lookup"><span data-stu-id="03cea-134">In this example, the effective discount percentage for discount 1 varies from a few percent (when the prices of the two products are far apart) to a maximum of 25 percent (when the two products have the same price).</span></span> <span data-ttu-id="03cea-135">Den effektiv rabattprocenten för rabatt 2 är fast.</span><span class="sxs-lookup"><span data-stu-id="03cea-135">The effective discount percentage for discount 2 is fixed.</span></span> <span data-ttu-id="03cea-136">Den är alltid 20 procent.</span><span class="sxs-lookup"><span data-stu-id="03cea-136">It's always 20 percent.</span></span> <span data-ttu-id="03cea-137">Eftersom den effektiva rabattprocenten för rabatten 1 har ett intervall som kan vara mer än eller mindre än rabatt 2 är den bästa rabatten beroende av priserna för de två produkter som måste rabatteras.</span><span class="sxs-lookup"><span data-stu-id="03cea-137">Because the effective discount percentage for discount 1 has a range that can be more than or less than discount 2, the best discount depends on the prices of the two products that must be discounted.</span></span> <span data-ttu-id="03cea-138">I det här exemplet slutfördes beräkningen snabbt, eftersom endast två rabatter tillämpas på endast två produkter.</span><span class="sxs-lookup"><span data-stu-id="03cea-138">In this example, the calculation is completed quickly, because only two discounts are applied on only two products.</span></span> <span data-ttu-id="03cea-139">Det finns två möjliga kombinationer: ett användning av rabatt 1 eller en användning av rabatt 2.</span><span class="sxs-lookup"><span data-stu-id="03cea-139">There are only two possible combinations: one application of discount 1 or one application of discount 2.</span></span> <span data-ttu-id="03cea-140">Det finns inga permutationer att beräkna.</span><span class="sxs-lookup"><span data-stu-id="03cea-140">There are no permutations to calculate.</span></span> <span data-ttu-id="03cea-141">Värdet för varje rabatt beräknas med hjälp av båda produkterna och bästa rabatten används.</span><span class="sxs-lookup"><span data-stu-id="03cea-141">The value of each discount is calculated by using both products, and the best discount is used.</span></span>

### <a name="example-2-four-products-and-two-discounts"></a><span data-ttu-id="03cea-142">Exempel 2: Fyra produkter och två rabatter</span><span class="sxs-lookup"><span data-stu-id="03cea-142">Example 2: Four products and two discounts</span></span>

<span data-ttu-id="03cea-143">Nu ska använda fyra produkter och samma två rabatter.</span><span class="sxs-lookup"><span data-stu-id="03cea-143">Next, we will use four products and the same two discounts.</span></span> <span data-ttu-id="03cea-144">Alla fyra produkterna uppfyller kraven för båda rabatterna.</span><span class="sxs-lookup"><span data-stu-id="03cea-144">All four products qualify for both discounts.</span></span> <span data-ttu-id="03cea-145">Det finns tolv möjliga kombinationer.</span><span class="sxs-lookup"><span data-stu-id="03cea-145">There are twelve possible combinations.</span></span> <span data-ttu-id="03cea-146">I slutändan ska två rabatter användas på transaktionen i någon av tre kombinationer: två användningar av rabatt 1, två användningar av rabatt 2 eller en användning av rabatt 1 och en användning av rabatt 2.</span><span class="sxs-lookup"><span data-stu-id="03cea-146">In the end, two discounts will be applied to the transaction in one of three combinations: two applications of discount 1, two applications of discount 2, or one application of discount 1 and one application of discount 2.</span></span> <span data-ttu-id="03cea-147">För att illustrera de möjliga kombinationerna ska vi titta på två olika uppsättningar med fyra produkter som har olika priser:</span><span class="sxs-lookup"><span data-stu-id="03cea-147">To illustrate the possible combinations, we will look at two different sets of four products that have different prices:</span></span>

- <span data-ttu-id="03cea-148">Alla fyra produkterna har samma pris, $15,00.</span><span class="sxs-lookup"><span data-stu-id="03cea-148">All four products have the same price, $15.00.</span></span> <span data-ttu-id="03cea-149">I det här fallet är den bästa kombinationen två användningar av rabatt 1.</span><span class="sxs-lookup"><span data-stu-id="03cea-149">In this case, the best discount combination is two applications of discount 1.</span></span> <span data-ttu-id="03cea-150">Två produkter får fullt pris och två får 50 procent rabatt.</span><span class="sxs-lookup"><span data-stu-id="03cea-150">Two products will be full price, and two will be 50 percent off.</span></span> <span data-ttu-id="03cea-151">Den rabatterade summan för transaktionen är $45 (15 + 15 + 7,50 + 7,50), vilket är $15 (25 procent) av den orabatterade summan på $60.</span><span class="sxs-lookup"><span data-stu-id="03cea-151">The discounted total for the transaction is $45 (15 + 15 + 7.50 + 7.50), which is $15 (25 percent) off the undiscounted total of $60.</span></span> <span data-ttu-id="03cea-152">Rabatt 2 är bara $12 (20 procent).</span><span class="sxs-lookup"><span data-stu-id="03cea-152">Discount 2 is only $12 (20 percent).</span></span>
- <span data-ttu-id="03cea-153">Två produkter kostar $20 var, en produkt koster $15 och en produkt kostar $5.</span><span class="sxs-lookup"><span data-stu-id="03cea-153">Two products are $20 each, one product is $15, and one product is $5.</span></span> <span data-ttu-id="03cea-154">I det här fallet är den bästa kombinationen en användning av rabatt 2 och en användning av rabatt 1.</span><span class="sxs-lookup"><span data-stu-id="03cea-154">In this case, the best discount combination is one application of discount 2 and one application of discount 1.</span></span> <span data-ttu-id="03cea-155">Följande tabeller visar rabatterna.</span><span class="sxs-lookup"><span data-stu-id="03cea-155">The following tables illustrates the discounts.</span></span>

<span data-ttu-id="03cea-156">För att läsa tabellerna, använd en produkt från en rad och en produkt från en kolumn.</span><span class="sxs-lookup"><span data-stu-id="03cea-156">To read the tables, use one product from a row and one product from a column.</span></span> <span data-ttu-id="03cea-157">Till exempel i tabellen för rabatt 1, när du kombinerar de två $20-produkterna, får du $10 rabatt.</span><span class="sxs-lookup"><span data-stu-id="03cea-157">For example, in the table for discount 1, when you combine the two $20 products, you get $10 off.</span></span> <span data-ttu-id="03cea-158">I tabellen för rabatt 2, när du kombinerar $15-produkten och $5-produkten, får du $4 rabatt.</span><span class="sxs-lookup"><span data-stu-id="03cea-158">In the table for discount 2, when you combine the $15 product and the $5 product, you get $4 off.</span></span>

![Exempel på användning av fyra produkter för samma två rabatter](./media/overlapping-discount-combo-03.jpg)

<span data-ttu-id="03cea-160">Först letar vi reda på den största möjliga rabatten för två produkter genom att använda någondera av rabatterna.</span><span class="sxs-lookup"><span data-stu-id="03cea-160">First, we find the largest discount that is available from any two products by using either discount.</span></span> <span data-ttu-id="03cea-161">De två tabellerna visar rabattbeloppet för alla kombinationer av de två produkterna.</span><span class="sxs-lookup"><span data-stu-id="03cea-161">The two tables show the discount amount for all combinations of the two products.</span></span> <span data-ttu-id="03cea-162">Den skuggade delen av tabellerna representerar antingen fall där en produkt är ihopparad med sig själv, vilket vi inte kan göra, eller en omvänd ihopparning av två produkter som ger samma rabattbelopp och kan ignoreras.</span><span class="sxs-lookup"><span data-stu-id="03cea-162">The shaded portions of the tables represent either cases where a product is paired with itself, which we can't do, or a reverse pairing of two products that produces the same discount amount and can be ignored.</span></span> <span data-ttu-id="03cea-163">Genom att titta i tabellerna ser du att rabatt 1 för de två $20-artiklarna är den största möjliga rabatten för någon rabatt på alla fyra produkterna.</span><span class="sxs-lookup"><span data-stu-id="03cea-163">By looking at the tables, you can see that discount 1 for the two $20 items is the largest discount that is available for either discount on all four products.</span></span> <span data-ttu-id="03cea-164">(Den här rabatten markeras med grönt i den första tabellen.) Kvar finns då $15-produkten och $5-produkten.</span><span class="sxs-lookup"><span data-stu-id="03cea-164">(This discount is highlighted in green in the first table.) That leaves only the $15 product and the $5 product.</span></span> <span data-ttu-id="03cea-165">Genom att titta på de två tabellerna igen ser du att rabatt 1 för dessa två produkter ger en rabatt på $2,50, medan rabatt 2 ger en rabatt på $4.</span><span class="sxs-lookup"><span data-stu-id="03cea-165">By looking at the two tables again, you can see that, for these two products, discount 1 gives a $2.50 discount, whereas discount 2 gives a $4 discount.</span></span> <span data-ttu-id="03cea-166">Vi väljer därför rabatt 2.</span><span class="sxs-lookup"><span data-stu-id="03cea-166">Therefore, we select discount 2.</span></span> <span data-ttu-id="03cea-167">Totalrabatten är $14.</span><span class="sxs-lookup"><span data-stu-id="03cea-167">The total discount is $14.</span></span> <span data-ttu-id="03cea-168">För att göra den här diskussionen enklare att visualisera är här två ytterligare tabeller som visar den effektiva rabattprocenten för alla möjliga kombinationer av två produkter för både rabatt 1 och rabatt 2.</span><span class="sxs-lookup"><span data-stu-id="03cea-168">To make this discussion easier to visualize, here are two additional tables that show the effective discount percentage for all possible two-product combinations for both discount 1 and discount 2.</span></span> <span data-ttu-id="03cea-169">Endast halva listan över kombinationer ingår, eftersom det för dessa två rabatter inte spelar någon roll i vilken ordning de två produkterna tas med i rabatten.</span><span class="sxs-lookup"><span data-stu-id="03cea-169">Only half the list of combinations is included, because, for these two discounts, the order in which the two products are put into the discount doesn't matter.</span></span> <span data-ttu-id="03cea-170">Den högsta effektiva rabatten (25 procent)markeras med grönt och lägsta effektiva rabatten (10 procent) markeras i rött.</span><span class="sxs-lookup"><span data-stu-id="03cea-170">The highest effective discount (25 percent) is highlighted in green, and the lowest effective discount (10 percent) is highlighted in red.</span></span>

![Effektiv rabatt i procent för alla kombinationer med två produkter för båda rabatterna](./media/overlapping-discount-combo-04.jpg)

> [!NOTE]
> <span data-ttu-id="03cea-172">När priserna varierar, och två eller flera rabatter konkurrerar, är det enda sättet att garantera den bästa rabattkombinationen att utvärdera båda rabatter och jämföra dem.</span><span class="sxs-lookup"><span data-stu-id="03cea-172">When prices vary, and two or more discount compete, the only way to guarantee the best combination of discounts is to evaluate both discounts and compare them.</span></span>

## <a name="total-possible-combinations"></a><span data-ttu-id="03cea-173">Totalt antal möjliga kombinationer</span><span class="sxs-lookup"><span data-stu-id="03cea-173">Total possible combinations</span></span>

<span data-ttu-id="03cea-174">Det här avsnittet fortsätter med exemplet i det föregående avsnittet.</span><span class="sxs-lookup"><span data-stu-id="03cea-174">This section continues the example from the previous section.</span></span> <span data-ttu-id="03cea-175">Vi ska lägga till fler produkter och ytterligare en rabatt och se hur många kombinationer som måste beräknas och jämförs.</span><span class="sxs-lookup"><span data-stu-id="03cea-175">We will add more products and another discount, and see how many combinations must be calculated and compared.</span></span> <span data-ttu-id="03cea-176">Tabellen nedan visar antalet möjliga rabattkombinationer allt eftersom produktkvantiteten ökar.</span><span class="sxs-lookup"><span data-stu-id="03cea-176">The following table shows the number of possible discount combinations as the product quantity increases.</span></span> <span data-ttu-id="03cea-177">I tabellen visas vad som händer, både när det finns två överlappande rabatter, som i föregående exempel, och när det finns tre överlappande rabatter.</span><span class="sxs-lookup"><span data-stu-id="03cea-177">The table shows what happens both when there are two overlapping discounts, as in the previous example, and when there are three overlapping discounts.</span></span> <span data-ttu-id="03cea-178">Antalet möjliga rabattkombinationer som måste bedömas överskrider snart vad även en snabb dator kan beräkna och jämföra tillräckligt snabbt för att kunna godtas för butikstransaktioner.</span><span class="sxs-lookup"><span data-stu-id="03cea-178">The number of possible discount combinations that must be evaluated soon exceeds what even a fast computer can calculate and compare quickly enough to be acceptable for retail transactions.</span></span>

![Antalet möjliga rabattkombinationer allt eftersom produktkvantiteten ökar.](./media/overlapping-discount-combo-05.jpg)

<span data-ttu-id="03cea-180">När ännu större kvantiteter eller fler överlappande rabatter används blir det totala antalet möjliga rabattkombinationer snabbt miljontals, och den tid som krävs för att utvärdera och välja den bästa möjliga kombinationen blir snabbt betydande.</span><span class="sxs-lookup"><span data-stu-id="03cea-180">When even larger quantities or more overlapping discounts are applied, the total number of possible discount combinations quickly goes into the millions, and the time that is required in order to evaluate and select the best possible combination quickly becomes noticeable.</span></span> <span data-ttu-id="03cea-181">Vissa optimeringar har gjorts i butiksprismotorn för att minska det totala antalet kombinationer som måste utvärderas.</span><span class="sxs-lookup"><span data-stu-id="03cea-181">Some optimizations have been done in the retail price engine to reduce the total number of combinations that must be evaluated.</span></span> <span data-ttu-id="03cea-182">Men eftersom antalet överlappande rabatter och kvantiteterna i en transaktion inte är begränsade måste ett stort antal kombinationer alltid utvärderas när det finns överlappande rabatter.</span><span class="sxs-lookup"><span data-stu-id="03cea-182">However, because the number overlapping discounts and the quantities in a transaction aren't limited, a large number of combinations will always have to be evaluated whenever there are overlapping discounts.</span></span> <span data-ttu-id="03cea-183">Detta är problemet som metoden för marginalvärderankning hanterar.</span><span class="sxs-lookup"><span data-stu-id="03cea-183">This issue is the issue that the marginal value ranking method addresses.</span></span>

## <a name="marginal-value-method"></a><span data-ttu-id="03cea-184">Marginalvärdemetod</span><span class="sxs-lookup"><span data-stu-id="03cea-184">Marginal value method</span></span>

<span data-ttu-id="03cea-185">För att lösa problemet med ett exponentiellt ökande antal kombinationer som måste utvärderas, finns en optimering som beräknar värdet per delad produkt för varje rabatt i uppsättningen med produkter som två eller flera rabatter kan tillämpas på.</span><span class="sxs-lookup"><span data-stu-id="03cea-185">To resolve the issue of an exponentially increasing number of combinations that must be evaluated, an optimization exists that calculates the value per shared product of each discount on the set of products that two or more discounts can be applied to.</span></span> <span data-ttu-id="03cea-186">Vi kallar detta värde för **marginalvärdet** på rabatten för de delade produkterna.</span><span class="sxs-lookup"><span data-stu-id="03cea-186">We refer to this value as the **marginal value** of the discount for the shared products.</span></span> <span data-ttu-id="03cea-187">Marginalvärdet är den genomsnittliga ökningen per produkt av det totala rabattbeloppet när delade produkter tas med i varje rabatt.</span><span class="sxs-lookup"><span data-stu-id="03cea-187">The marginal value is the average per product increase in the total discount amount when the shared products are included in each discount.</span></span> <span data-ttu-id="03cea-188">Marginalvärdet beräknas genom att det totala rabattbeloppet (DTotal), dra av rabattbeloppet utan de delade produkterna (DMinus\\ Shared), och dividera denna skillnad med antalet delade produkter (ProductsShared).</span><span class="sxs-lookup"><span data-stu-id="03cea-188">The marginal value is calculated by taking the total discount amount (DTotal), subtracting the discount amount without the shared products (DMinus\\ Shared), and dividing that difference by the number of shared products (ProductsShared).</span></span>

![Formel för beräkning av marginalvärde](./media/overlapping-discount-combo-06.jpg)

<span data-ttu-id="03cea-190">När marginalvärdet av varje rabatt i en delad uppsättning produkter beräknas, tillämpas rabatterna på de delade produkterna i ordning och fullständigt, från högsta marginalvärde till lägsta marginalvärde.</span><span class="sxs-lookup"><span data-stu-id="03cea-190">After the marginal value of each discount on a shared set of products is calculated, the discounts are applied to the shared products in order, exhaustively, from highest marginal value to lowest marginal value.</span></span> <span data-ttu-id="03cea-191">För den här metoden jämförs inte alla resterande rabattmöjligheter varje gång när en enda instans av en rabatt har tillämpats.</span><span class="sxs-lookup"><span data-stu-id="03cea-191">For this method, all remaining discount possibilities aren't compared every time after a single instance of a discount is applied.</span></span> <span data-ttu-id="03cea-192">I stället jämförs överlappande rabatter en gång och tillämpas sedan i ordning.</span><span class="sxs-lookup"><span data-stu-id="03cea-192">Instead, the overlapping discounts are compared one time and then applied in order.</span></span> <span data-ttu-id="03cea-193">Inga ytterligare jämförelser görs.</span><span class="sxs-lookup"><span data-stu-id="03cea-193">No additional comparisons are done.</span></span> <span data-ttu-id="03cea-194">Du kan konfigurera tröskeln att byta till marginalvärdesmetoden på fliken **Rabatt** på sidan **Butiksparametrar**.</span><span class="sxs-lookup"><span data-stu-id="03cea-194">You can configure the threshold to switch to the marginal value method on the **Discount** tab of the **Retail parameters** page.</span></span> <span data-ttu-id="03cea-195">Den godtagbar tiden att beräkna den totala rabatten varierar mellan butiksbranscher.</span><span class="sxs-lookup"><span data-stu-id="03cea-195">The acceptable time to calculate the total discount varies across retail industries.</span></span> <span data-ttu-id="03cea-196">Tiden ligger dock vanligtvis mellan tiotals millisekunder och en sekund.</span><span class="sxs-lookup"><span data-stu-id="03cea-196">However, this time generally falls in the range of tens of milliseconds to one second.</span></span>
