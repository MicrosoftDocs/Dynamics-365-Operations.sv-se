---
title: Konfigurera dataimport från SharePoint
description: Det här avsnittet beskriver hur du importerar data från Microsoft SharePoint.
author: NickSelin
manager: AnnBe
ms.date: 11/29/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: b40f9a5677fd5375d7a19a75400d4305a8850392
ms.sourcegitcommit: 399e861ca6f2bdcd4fe84d89fedc04b60d9f43e6
ms.translationtype: HT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/07/2019
ms.locfileid: "2564947"
---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="9a6bf-103">Konfigurera dataimport från SharePoint</span><span class="sxs-lookup"><span data-stu-id="9a6bf-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="9a6bf-104">Om du vill importera data från en inkommande fil med ramverket för elektronisk rapportering (ER) måste du konfigurera ett ER-format som stöder import och sedan köra en modellmappning av typen **Till mål** som använder det formatet som en datakälla.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="9a6bf-105">När du importerar data måste du gå till den fil som du vill importera.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="9a6bf-106">Den importerade filen kan manuellt väljas av användaren.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="9a6bf-107">Med den nya ER-kapaciteten för att stödja import av data från Microsoft SharePoint kan den här processen konfigureras som obevakad.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as unattended.</span></span> <span data-ttu-id="9a6bf-108">Du kan använda ER-konfigurationer för att utföra dataimport från filer som är lagrade i Microsoft SharePoint-mappar.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="9a6bf-109">Det här avsnittet beskrivs hur du slutför importen från SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-109">This topic explains how to complete the import from SharePoint.</span></span> <span data-ttu-id="9a6bf-110">I exemplen används leverantörstransaktioner som affärsdata.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="9a6bf-111">Förutsättningar</span><span class="sxs-lookup"><span data-stu-id="9a6bf-111">Prerequisites</span></span>
<span data-ttu-id="9a6bf-112">För att slutföra exemplet i det här avsnittet måste du ha följande åtkomst:</span><span class="sxs-lookup"><span data-stu-id="9a6bf-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="9a6bf-113">Gå till någon av följande roller:</span><span class="sxs-lookup"><span data-stu-id="9a6bf-113">Access one of the following roles:</span></span>

    - <span data-ttu-id="9a6bf-114">Utvecklare för elektronisk rapportering</span><span class="sxs-lookup"><span data-stu-id="9a6bf-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="9a6bf-115">Konsult för funktionen för elektronisk rapportering</span><span class="sxs-lookup"><span data-stu-id="9a6bf-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="9a6bf-116">Systemadministratör</span><span class="sxs-lookup"><span data-stu-id="9a6bf-116">System administrator</span></span>

- <span data-ttu-id="9a6bf-117">Åtkomst till instansen på Microsoft SharePoint Server som konfigureras för användning med appen.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-117">Access to the instance of Microsoft SharePoint Server that is configured for use with the application.</span></span>
- <span data-ttu-id="9a6bf-118">ER-format och modellkonfigurationer för 1099-betalningar.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-118">ER format and model configurations for 1099 payments.</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="9a6bf-119">Skapa nödvändiga ER-konfigurationer</span><span class="sxs-lookup"><span data-stu-id="9a6bf-119">Create required ER configurations</span></span>
<span data-ttu-id="9a6bf-120">Spela upp uppgiftsguiden **ER data från en Microsoft Excel-fil** som är en del av affärsprocessen **7.5.4.3 hämta/utveckla IT-tjänst/lösningskomponenter (10677)**.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="9a6bf-121">Dessa uppgiftsguider förklarar processen med hur du utformar och använder ER-konfigurationer för att interaktivt importera leverantörstransaktioner från filer i Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from Microsoft Excel files.</span></span> <span data-ttu-id="9a6bf-122">Mer information finns i [Tolka inkommande dokument i Microsoft Excel](parse-incoming-documents-excel.md).</span><span class="sxs-lookup"><span data-stu-id="9a6bf-122">For more information, see [Parse incoming documents in Microsoft Excel](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="9a6bf-123">När du har slutfört uppgiftsguiderna måste du ställa in följande.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-123">After you have completed the task guides, you will have the following set up.</span></span>

#### <a name="er-configurations"></a><span data-ttu-id="9a6bf-124">ER-konfigurationer</span><span class="sxs-lookup"><span data-stu-id="9a6bf-124">ER configurations</span></span>

- <span data-ttu-id="9a6bf-125">ER-modellkonfiguration **1099-betalningsmodell**</span><span class="sxs-lookup"><span data-stu-id="9a6bf-125">ER model configuration, **1099 Payments model**</span></span>
- <span data-ttu-id="9a6bf-126">ER-formatkonfiguration **Format för import av leverantörernas transaktioner från Excel**</span><span class="sxs-lookup"><span data-stu-id="9a6bf-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

![ER-konfigurationer för import av data från SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)

#### <a name="sample-of-the-incoming-file-for-data-import"></a><span data-ttu-id="9a6bf-128">Exempel på den importerade filen för dataimport</span><span class="sxs-lookup"><span data-stu-id="9a6bf-128">Sample of the incoming file for data import</span></span>

- <span data-ttu-id="9a6bf-129">Excel-filen **1099import-data.xlsx** med leverantörstransaktioner som ska importeras.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported.</span></span>

![Microsoft Excel-exempelfil som ska importeras från SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)
    
> [!NOTE]
> <span data-ttu-id="9a6bf-131">Format för import av leverantörstransaktioner väljs som standardvärde för modellmappning.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="9a6bf-132">Därför om du kör en modellmappning av **1099-betalningsmodell** och den modellmappningen är av typen **till målet** kör modellmappningen det här formatet för att importera data från externa filer.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="9a6bf-133">Den använder sedan den data för att uppdatera programregister.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-133">It then uses that data to update application tables.</span></span>

## <a name="configure-access-to-sharepoint-for-file-storage"></a><span data-ttu-id="9a6bf-134">Konfigurera åtkomst till SharePoint för lagring av filer</span><span class="sxs-lookup"><span data-stu-id="9a6bf-134">Configure access to SharePoint for file storage</span></span>
<span data-ttu-id="9a6bf-135">Om du vill lagra elektroniska rapportfiler på en SharePoint-plats, måste du konfigurera åtkomst till SharePoint Server-instansen som används av det aktuella företaget.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-135">To store electronic report files in a SharePoint location, you must configure access to the SharePoint Server instance that will be used by the current company.</span></span> <span data-ttu-id="9a6bf-136">I det här exemplet är USMF företaget.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-136">In this example, the company is USMF.</span></span> <span data-ttu-id="9a6bf-137">Instruktioner finns i [Konfigurera SharePoint-lagring](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span><span class="sxs-lookup"><span data-stu-id="9a6bf-137">For instructions, see [Configure SharePoint storage](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>

1. <span data-ttu-id="9a6bf-138">Följ instruktionerna i [Konfigurera SharePoint-lagring](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span><span class="sxs-lookup"><span data-stu-id="9a6bf-138">Complete the steps in [Configure SharePoint storage](../../fin-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>
2. <span data-ttu-id="9a6bf-139">Öppna den konfigurerade SharePoint-siten.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-139">Open the configured SharePoint site.</span></span>
3. <span data-ttu-id="9a6bf-140">Skapa följande mappar där inkommande elektroniska rapportfiler kan lagras:</span><span class="sxs-lookup"><span data-stu-id="9a6bf-140">Create the following folders where incoming electronic reporting files can be stored:</span></span>

     - <span data-ttu-id="9a6bf-141">Filimportkälla (huvudsaklig) (exempel framgår av bilden nedan)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-141">Files import source (main) (Example shown in screenshot below)</span></span>
     - <span data-ttu-id="9a6bf-142">Filimportkälla (alternativ)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-142">Files import source (alternative)</span></span>

    ![Filimportkälla (huvudsaklig)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)

4. <span data-ttu-id="9a6bf-144">(Valfritt) Skapa följande mappar där inkommande filer kan lagras efter import.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-144">(Optional) Create the following folders where the files can be stored after import.</span></span> 

    - <span data-ttu-id="9a6bf-145">Arkivera arkivmapp - den här mappen är för importerade filer.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-145">Files archive folder - This folder would be for successfully imported files.</span></span>
    - <span data-ttu-id="9a6bf-146">Mapp för filer med varning - den här mappen är för filer som importerades med en varning.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-146">Files warning folder - This folder would be for files that were imported with a warning.</span></span>
    - <span data-ttu-id="9a6bf-147">Mapp för filer med fel - den här mappen är för filer som misslyckades med import.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-147">Files error folder - This folder would be for files that failed to import.</span></span>

4. <span data-ttu-id="9a6bf-148">Gå till **Organisationsadministration > Dokumenthantering > Dokumenttyper**.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-148">Go to **Organization administration > Document management > Document types**.</span></span>
5. <span data-ttu-id="9a6bf-149">Skapa följande dokumenttyper som ska användas för att komma åt SharePoint-mappar som du har skapat.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-149">Create the following document types that will be used to access the SharePoint folders that you just created.</span></span> <span data-ttu-id="9a6bf-150">Instruktioner finns i [Konfigurera dokumenttyper](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types).</span><span class="sxs-lookup"><span data-stu-id="9a6bf-150">For instructions, see [Configure document types](../../fin-ops/organization-administration/configure-document-management.md#configure-document-types).</span></span>

|<span data-ttu-id="9a6bf-151">Dokumenttyp</span><span class="sxs-lookup"><span data-stu-id="9a6bf-151">Document type</span></span>       | <span data-ttu-id="9a6bf-152">Grupp</span><span class="sxs-lookup"><span data-stu-id="9a6bf-152">Group</span></span>              | <span data-ttu-id="9a6bf-153">Plats</span><span class="sxs-lookup"><span data-stu-id="9a6bf-153">Location</span></span>      | <span data-ttu-id="9a6bf-154">SharePoint-mapp</span><span class="sxs-lookup"><span data-stu-id="9a6bf-154">SharePoint folder</span></span>      |
|--------------------|--------------------|---------------|------------------------|
|<span data-ttu-id="9a6bf-155">SP huvudsaklig</span><span class="sxs-lookup"><span data-stu-id="9a6bf-155">SP Main</span></span>             |<span data-ttu-id="9a6bf-156">Fil</span><span class="sxs-lookup"><span data-stu-id="9a6bf-156">File</span></span>                |<span data-ttu-id="9a6bf-157">SharePoint</span><span class="sxs-lookup"><span data-stu-id="9a6bf-157">SharePoint</span></span>     |<span data-ttu-id="9a6bf-158">Filimportkälla (huvudsaklig)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-158">Files import source (main)</span></span>|
|<span data-ttu-id="9a6bf-159">SP alternativ</span><span class="sxs-lookup"><span data-stu-id="9a6bf-159">SP Alternative</span></span>             |<span data-ttu-id="9a6bf-160">Fil</span><span class="sxs-lookup"><span data-stu-id="9a6bf-160">File</span></span>                |<span data-ttu-id="9a6bf-161">SharePoint</span><span class="sxs-lookup"><span data-stu-id="9a6bf-161">SharePoint</span></span>     |<span data-ttu-id="9a6bf-162">Filimportkälla (alternativ)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-162">Files import source (alternative)</span></span>|
|<span data-ttu-id="9a6bf-163">SP-arkiv</span><span class="sxs-lookup"><span data-stu-id="9a6bf-163">SP Archive</span></span>             |<span data-ttu-id="9a6bf-164">Fil</span><span class="sxs-lookup"><span data-stu-id="9a6bf-164">File</span></span>                |<span data-ttu-id="9a6bf-165">SharePoint</span><span class="sxs-lookup"><span data-stu-id="9a6bf-165">SharePoint</span></span>     |<span data-ttu-id="9a6bf-166">Arkivera arkivmapp</span><span class="sxs-lookup"><span data-stu-id="9a6bf-166">Files archive folder</span></span>|
|<span data-ttu-id="9a6bf-167">SP-varning</span><span class="sxs-lookup"><span data-stu-id="9a6bf-167">SP Warning</span></span>             |<span data-ttu-id="9a6bf-168">Fil</span><span class="sxs-lookup"><span data-stu-id="9a6bf-168">File</span></span>                |<span data-ttu-id="9a6bf-169">SharePoint</span><span class="sxs-lookup"><span data-stu-id="9a6bf-169">SharePoint</span></span>     |<span data-ttu-id="9a6bf-170">Mapp för filer med varning</span><span class="sxs-lookup"><span data-stu-id="9a6bf-170">Files warning folder</span></span>|
|<span data-ttu-id="9a6bf-171">SP-fel</span><span class="sxs-lookup"><span data-stu-id="9a6bf-171">SP Error</span></span>             |<span data-ttu-id="9a6bf-172">Fil</span><span class="sxs-lookup"><span data-stu-id="9a6bf-172">File</span></span>                |<span data-ttu-id="9a6bf-173">SharePoint</span><span class="sxs-lookup"><span data-stu-id="9a6bf-173">SharePoint</span></span>     |<span data-ttu-id="9a6bf-174">Mapp för filer med fel</span><span class="sxs-lookup"><span data-stu-id="9a6bf-174">Files error folder</span></span>|

![SharePoint inställning - ny dokumenttyp](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="9a6bf-176">Konfigurera ER källor för ER-format</span><span class="sxs-lookup"><span data-stu-id="9a6bf-176">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="9a6bf-177">Klicka på **Organisationsadministration** \> **Elektronisk rapportering** \> **Elektronisk rapporteringskälla**.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-177">Click **Organization administration** \> **Electronic reporting** \> **Electronic reporting source**.</span></span>
2. <span data-ttu-id="9a6bf-178">På sidan **Elektronisk rapporteringskälla** kan du konfigurera källfilerna för dataimport genom att använda det konfigurerade ER-formatet.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-178">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="9a6bf-179">Ange en filnamnmask så att endast filer med filtillägget .xlsx importeras.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-179">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="9a6bf-180">Filnamnmasken är valfri och används endast när den har definierats.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-180">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="9a6bf-181">Du kan endast definiera en mask för varje ER-format.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-181">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="9a6bf-182">Ändra **sortera filer före import** till **sortera inte**, om det finns många filer som ska importeras och ordningen för import är inte viktig</span><span class="sxs-lookup"><span data-stu-id="9a6bf-182">Change **Sort files before import** to **Do not sort**, if there are a lot of files for import and the import order is not important</span></span>
5. <span data-ttu-id="9a6bf-183">Markera alla SharePoint-mapparna som du skapade tidigare.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-183">Select all SharePoint folders that you created earlier.</span></span>

    <span data-ttu-id="9a6bf-184">[![Inställning av ER-källfiler](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-184">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
> - <span data-ttu-id="9a6bf-185">*ER-källa* definieras för varje programföretag individuellt.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-185">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="9a6bf-186">Däremot delas *ER-konfigurationer* mellan flera företag.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-186">By contrast, ER *configurations* are shared across companies.</span></span>
> - <span data-ttu-id="9a6bf-187">När du tar bort en inställning för ER-källan för ett ER-format tas även alla kopplade fillägen bort genom bekräftelse (se nedan).</span><span class="sxs-lookup"><span data-stu-id="9a6bf-187">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted by confirmation.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="9a6bf-188">Granska filtillstånden för ER-format</span><span class="sxs-lookup"><span data-stu-id="9a6bf-188">Review the files states for the ER format</span></span>
1. <span data-ttu-id="9a6bf-189">På sidan **källa för elektronisk rapportering** väljer du **filtillstånd för källorna** för att granska innehållet i de konfigurerade filkällorna för det aktuella ER-formatet.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-189">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="9a6bf-190">I avsnittet **filer**, granska listan med filer.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-190">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="9a6bf-191">Den här listan innehåller följande:</span><span class="sxs-lookup"><span data-stu-id="9a6bf-191">This list presents the following:</span></span>

    - <span data-ttu-id="9a6bf-192">Källfilerna som är tillämpliga baserade på filnamn (om en filnamnmask anges), och som är redo för dataimport.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-192">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="9a6bf-193">För dessa filer är avsnittet **Källoggar för importformatet** är tomt.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-193">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="9a6bf-194">Tidigare importerade filer.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-194">Previously imported files.</span></span> <span data-ttu-id="9a6bf-195">För var och en av dessa filer i avsnittet **Källoggar för importformatet** kan du granska historik för import av filen.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-195">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="9a6bf-196">Du kan också öppna sidan **Filtillstånd för källorna** genom att välja **Organisationsadministration**\>**Elektronisk rapportering**\>**Filtillstånd för källorna**.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-196">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="9a6bf-197">I det här fallet innehåller sidan information om filkällor för alla ER-format som filkällorna har konfigurerats för för företaget som du är inloggad i.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-197">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="9a6bf-198">Importera data från Excel-filer som är i en mapp i SharePoint</span><span class="sxs-lookup"><span data-stu-id="9a6bf-198">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="9a6bf-199">I SharePoint överför Microsoft Excel-fil **1099import-data.xlsx** som innehåller leverantörstransaktionerna till **Filimportkälla (huvudsaklig)** SharePoint-mapp som du skapade tidigare.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-199">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

    <span data-ttu-id="9a6bf-200">[![SharePoint innehåll – Microsoft Excel-fil som ska importeras](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-200">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="9a6bf-201">På sidan **Filtillstånd för källorna**, välj **Uppdatera**för att uppdatera sidan.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-201">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="9a6bf-202">Observera att Excel-filen som överfördes till SharePoint visades på den här sidan med statusen **klar**.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-202">Note that the Excel file that was uploaded to SharePoint appeared on this page with the status **Ready**.</span></span> <span data-ttu-id="9a6bf-203">Följande statusvärden stöds för närvarande:</span><span class="sxs-lookup"><span data-stu-id="9a6bf-203">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="9a6bf-204">**Klar** - tilldelas automatiskt för varje ny fil i en SharePoint-mapp.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-204">**Ready** – Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="9a6bf-205">Denna status innebär att filen är klar för import.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-205">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="9a6bf-206">**Importera** - tilldelas automatiskt av en ER-rapport när filen låses av importprocessen för att förhindra dess användning av andra processer (om många av dem körs samtidigt).</span><span class="sxs-lookup"><span data-stu-id="9a6bf-206">**Importing** – Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="9a6bf-207">**Importerad** - tilldelas automatiskt av en ER-rapport när filimporten är slutförd.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-207">**Imported** – Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="9a6bf-208">Denna status innebär att den importerade filen har tagits bort från den konfigurerade filkällan (SharePoint-mapp).</span><span class="sxs-lookup"><span data-stu-id="9a6bf-208">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="9a6bf-209">**Misslyckad** - tilldelas automatiskt av en ER-rapport när filimporten är slutförd med fel eller undantag.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-209">**Failed** – Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="9a6bf-210">**Spärrad** - tilldelas manuellt av användaren på den här sidan.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-210">**On hold** – Assigned manually by user on this page.</span></span> <span data-ttu-id="9a6bf-211">Denna status innebär att filen inte importeras just nu.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-211">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="9a6bf-212">Denna status kan användas för att skjuta upp importen av vissa filer.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-212">This status can be used to postpone the import of some files.</span></span>

    <span data-ttu-id="9a6bf-213">[![ER-fil anger sidan för valda källor](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-213">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="9a6bf-214">Importera data från SharePoint-fil.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-214">Import data from SharePoint files</span></span>
1. <span data-ttu-id="9a6bf-215">Öppnar ER-konfigurationsträdet, markera **1099-betalningsmodell** och utöka listan över ER-modellkomponenter.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-215">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="9a6bf-216">Välj namnet på modellmappning för att öppna listan över modellmappningar av den valda ER-modellkonfigurationen.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-216">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

    <span data-ttu-id="9a6bf-217">[![ER-fil anger sidan för valda källor](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-217">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="9a6bf-218">Välj **kör** för att köra den valda modellmappningen.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-218">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="9a6bf-219">Eftersom du har konfigurerat filkällor för ER-formatet kan du ändra inställningen för **Filkälla** enligt behov.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-219">Because you configured file sources for the ER format, you can change the setting of the **File source** option, if needed.</span></span> <span data-ttu-id="9a6bf-220">Om du sparar inställningen för det här alternativet importeras .xslx-filer från konfigurerade källor (SharePoint-mapparna, i det här exemplet).</span><span class="sxs-lookup"><span data-stu-id="9a6bf-220">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="9a6bf-221">I det här exemplet importerar du en enstaka fil.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-221">In this example, you're importing only one file.</span></span> <span data-ttu-id="9a6bf-222">Om det finns flera filer har de valts för import i den ordning som de lades till i SharePoint-mappen.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-222">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="9a6bf-223">Varje körning av ett ER-format importerar en enstaka vald fil.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-223">Every run of an ER format imports a single selected file.</span></span>

    <span data-ttu-id="9a6bf-224">[![Kör ER-modell-mappning](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-224">[![Run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="9a6bf-225">Modellmappningen kan köras automatiskt i batchläge.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-225">The model mapping can run unattended in batch mode.</span></span> <span data-ttu-id="9a6bf-226">I detta fall importeras varje gång som en batch kör detta ER-format, en enskild fil från konfigurerade filkällor.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-226">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span>

    <span data-ttu-id="9a6bf-227">När en fil har importerats från SharePoint-mappen, har den tagits bort från mappen och flyttas till mappen för importerade filer eller till mappen för importerade filer med varningar.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-227">When a file is successfully imported from the SharePoint folder, it's deleted from that folder and moved to folder for successful imported files or to the folder to imported files with warnings.</span></span> <span data-ttu-id="9a6bf-228">Annars flyttas den till mappen för misslyckade filer eller stannar kvar i den här mappen om mappen för misslyckade filer inte har konfigurerats.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-228">Otherwise it's moved to folder for failed files or stays in this folder if the folder for failed files isn't set up.</span></span> 

5. <span data-ttu-id="9a6bf-229">Ange verifikations-ID som **V-00001** och välj sedan **OK**.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-229">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

    <span data-ttu-id="9a6bf-230">[![Kör ER-modell-mappning](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-230">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="9a6bf-231">På sidan **Filtillstånd för källorna**, välj **Uppdatera**för att uppdatera sidan.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-231">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

    <span data-ttu-id="9a6bf-232">[![ER-fil anger sidan för valda källor](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-232">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="9a6bf-233">I avsnittet **filer**, granska listan med filer.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-233">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="9a6bf-234">Avsnittet **Källoggar för importformatet** ger historik för Excel-filimporten.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-234">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="9a6bf-235">Eftersom den här filen har importerats, markeras den som **borttagen** i SharePoint-mappen.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-235">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="9a6bf-236">Granska **Filimportkälla (huvudsaklig)** SharePoint-mapp.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-236">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="9a6bf-237">Excel-filerna som har importerats har tagits bort från den här mappen.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-237">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="9a6bf-238">Välj **Leverantörsreskontra** \> **Periodiska uppgifter** \> **1099-skatt** \> **Leverantörskvittning för 1099-rapportering**.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-238">Select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="9a6bf-239">I fälten **från datum** och **till datum** anger du lämpliga värden.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-239">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="9a6bf-240">Välj sedan **Manuella 1099-transaktioner**.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-240">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="9a6bf-241">Leverantörstransaktionerna som har importerats från Excel-filer i SharePoint för verifikation **V-00001**, visas på sidan.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-241">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

    <span data-ttu-id="9a6bf-242">[![1099 leverantörstransaktionssida](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-242">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="9a6bf-243">Förbered en Excel-fil för import</span><span class="sxs-lookup"><span data-stu-id="9a6bf-243">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="9a6bf-244">Öppna Excel-filen som du använt tidigare.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-244">Open the Excel file that you previously used.</span></span> <span data-ttu-id="9a6bf-245">I rad 3, kolumn 1, lägg till en leverantörskod som inte finns i programmet.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-245">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="9a6bf-246">Lägg till ytterligare falsk leverantörsinformation på raden.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-246">Add additional false vendor information to the row.</span></span>

    <span data-ttu-id="9a6bf-247">[![Exempel Microsoft Excel-filen för från SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-247">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="9a6bf-248">Skicka den uppdaterade Excel-filen som innehåller leverantörstransaktioner till SharePoint-mappen **Filimportkälla (huvudsaklig)**.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-248">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="9a6bf-249">Öppnar ER-konfigurationsträdet, markera **1099-betalningsmodell** och utöka listan över ER-modellkomponenter.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-249">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="9a6bf-250">Välj namnet på modellmappningen för att uppdatera modellmappningen så att den felaktiga leverantörskoden betraktas som ett fel under dataimporten.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-250">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="9a6bf-251">Välj **Designer**.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-251">Select **Designer**.</span></span>
6. <span data-ttu-id="9a6bf-252">På fliken **valideringar** måste du ändra åtgärd efter validering för valideringsregeln som har konfigurerats för att utvärdera om leverantörskontot som importeras finns i programmet.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-252">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="9a6bf-253">Uppdatera värdet för fältet **Åtgärd efter validering** till **Stoppa körning**, spara ändringarna och stäng sidan.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-253">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

    <span data-ttu-id="9a6bf-254">[![Sidan ER-modellmappningsdesigner](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-254">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="9a6bf-255">Spara ändringarna och stäng ER-modellmappningsdesigner.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-255">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="9a6bf-256">Välj **kör** för att köra den ändrade ER-modellmappningen.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-256">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="9a6bf-257">Ange verifikations-ID som **V-00002** och välj sedan **OK**.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-257">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="9a6bf-258">Observera att informationsloggen innehåller meddelandet att det finns en fil i SharePoint-mappen som innehåller felaktigt leverantörskonto och inte kan importeras.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-258">Note that the Infolog contains a notification that there's a file in the SharePoint folder that contains incorrect vendor account and can’t be imported.</span></span>

    <span data-ttu-id="9a6bf-259">[![Kör ER-modell-mappning](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-259">[![Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="9a6bf-260">På sidan **Filtillstånd för källorna**, välj **uppdatera**, och sedan, i avsnittet **filer** granskar du listan med filer.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-260">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

    <span data-ttu-id="9a6bf-261">[![ER-fil anger sidan för valda källor](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="9a6bf-261">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

   <span data-ttu-id="9a6bf-262">Avsnittet **Källoggar för importformatet** anger att importen har misslyckats och att filen är i SharePoint-mappen för filer med fel (kryssrutan **checkÄr borttagen** är inte markerad).</span><span class="sxs-lookup"><span data-stu-id="9a6bf-262">The **Sources log for the import format** section indicates that the import process failed and that the file is in the Files error SharePoint folder (the **Is deleted** check box is not selected).</span></span> <span data-ttu-id="9a6bf-263">Om du vill åtgärda filen i SharePoint genom att lägga till rätt leverantörskod och flytta den till SharePoint-mappen för filernas importkälla (huvudsaklig) kan du importera filen igen.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-263">If you fix this file on SharePoint by adding the proper vendor code and then move it to the Files import source (main) SharePoint folder, you can import the file again.</span></span>

11. <span data-ttu-id="9a6bf-264">Välj **Leverantörsreskontra** \> **Periodiska uppgifter** \> **1099-skatt** \> **Leverantörskvittning för 1099-rapportering**, ange tillämpliga värden i fälten **Från-datum** och **Till-datum** och markera **manuella 1099-transaktioner**.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-264">Select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="9a6bf-265">Endast transaktioner för verifikation V-00001 är tillgängliga.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-265">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="9a6bf-266">Inga transaktioner för verifikation V-00002 är tillgängliga även om felet för den senaste importerade transaktionen har hittats i Excel-filen.</span><span class="sxs-lookup"><span data-stu-id="9a6bf-266">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>
